<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600|Raleway:400,700" rel="stylesheet">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="/css/all.min.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <script src="/js/jquery-3.4.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <title>Site-DNMP</title>
</head>


<body>
    <style>
        section#header .logo-text {
            font-family: Raleway;
            font-weight: 400;
            font-size: 2.6em;
            white-space: nowrap;
        }
    </style>
    <section id="nav"></section>
    <section id="main-body">
        <div class="container">
            <div id="error"></div>
            <div class="page-header">
                <h1>Site <small id="domain"></small></h1>
            </div>
            <div class="row">
                <div class="container">
                    <div class="col-md-2">
                        <div class="btn-group-vertical" role="group" aria-label="Vertical button group">
                            <button type="button" class="btn btn-default">Certificate</button>
                            <button type="button" class="btn btn-default">Config</button>
                        </div>
                    </div>
                    <div class="col-md-10">
                        <div class="panel panel-default">
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <td>Domain</td>
                                        <td id="domainame"></td>
                                        <td>Status</td>
                                        <td id="sitestatus">enable</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="footer"></section>
    <script>
        $("#nav").load('/part/nav.html');
        $("#footer").load('/part/footer.html');
    </script>
    <script src="/js/config.js"></script>
    <script src="/js/checkPower.js"></script>
    <script>
        $.ajax({
            "url": apiaddress + "/web/SiteInfo",
            "method": "GET",
            "timeout": 0,
            "headers": {
                "Content-Type": "application/x-www-form-urlencoded",
                "Authorization": "Bearer " + userjwt
            },
            data: { name: window.location.search.replace('?name=', '') },
            success: function (data) {
                console.log(data)
                $('#domain')[0].innerHTML = window.location.search.replace('?name=', '')
                $('#domainame')[0].innerHTML = '<a href="http://' + window.location.search.replace('?name=', '') + '">' + window.location.search.replace('?name=', '') + '</a>'
                var i = new Number(data[0].cer)
                $.ajax({
                    "url": apiaddress + "/web/Certificate",
                    "method": "GET",
                    "timeout": 0,
                    "headers": {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "Authorization": "Bearer " + userjwt
                    },
                    data: { id: i },
                    success: function (data) {
                        console.log(data)
                    }
                })
            },
            error: function () {
                $('#error')[0].innerHTML = '<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span></button ><strong>Warning!</strong> 服务器连接失败!</div > '
            }
        });

        $('#logout').click(function () {
            clearCookie("jwt")
            window.location.pathname = "/login.html"
        })
        function setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + "; " + expires;
        }
        function clearCookie(name) {
            setCookie(name, "", -1);
        }
    </script>

</body>

</html>